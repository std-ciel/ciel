// Test short-circuiting behavior with combined AND (&&) and OR (||) operators
// ALL tests must evaluate expressions DIRECTLY in control flow (if/while/for)

int global_counter = 0;
int call_order[20];
int call_index = 0;

bool func_a() {
    call_order[call_index] = 1;
    call_index = call_index + 1;
    global_counter = global_counter + 1;
    return true;
}

bool func_b() {
    call_order[call_index] = 2;
    call_index = call_index + 1;
    global_counter = global_counter + 1;
    return false;
}

bool func_c() {
    call_order[call_index] = 3;
    call_index = call_index + 1;
    global_counter = global_counter + 1;
    return true;
}

bool func_d() {
    call_order[call_index] = 4;
    call_index = call_index + 1;
    global_counter = global_counter + 1;
    return false;
}

void reset_tracking() {
    global_counter = 0;
    call_index = 0;
    int i = 0;
    while (i < 20) {
        call_order[i] = 0;
        i = i + 1;
    }
}

int main() {
    // Test 1: false && func_a() || func_c() - AND short-circuits, then OR evaluates func_c
    reset_tracking();
    if (false && func_a() || func_c()) {
        if (global_counter != 1) return 1;
        if (call_order[0] != 3) return 2;
    } else return 3;
    
    // Test 2: true || func_a() && func_b() - OR short-circuits immediately
    reset_tracking();
    if (true || func_a() && func_b()) {
        if (global_counter != 0) return 4;
    } else return 5;
    
    // Test 3: func_a() && func_b() || func_c() - all three get called
    reset_tracking();
    if (func_a() && func_b() || func_c()) {
        if (global_counter != 3) return 6;
        if (call_order[0] != 1) return 7;
        if (call_order[1] != 2) return 8;
        if (call_order[2] != 3) return 9;
    } else return 10;
    
    // Test 4: func_b() || func_a() && func_c() - b is false, so evaluates a && c
    reset_tracking();
    if (func_b() || func_a() && func_c()) {
        if (global_counter != 3) return 11;
        if (call_order[0] != 2) return 12;
        if (call_order[1] != 1) return 13;
        if (call_order[2] != 3) return 14;
    } else return 15;
    
    // Test 5: (func_a() || func_b()) && func_c() - a is true, c is called
    reset_tracking();
    if ((func_a() || func_b()) && func_c()) {
        if (global_counter != 2) return 16;
        if (call_order[0] != 1) return 17;
        if (call_order[1] != 3) return 18;
    } else return 19;
    
    // Test 6: (func_b() || func_d()) && func_a() - both in () are false, AND short-circuits
    reset_tracking();
    if ((func_b() || func_d()) && func_a()) {
        return 20;
    } else {
        if (global_counter != 2) return 21;
        if (call_order[0] != 2) return 22;
        if (call_order[1] != 4) return 23;
    }
    
    // Test 7: (func_a() && func_c()) || (func_d() || func_b()) - first () is true, second not evaluated
    reset_tracking();
    if ((func_a() && func_c()) || (func_d() || func_b())) {
        if (global_counter != 2) return 24;
        if (call_order[0] != 1) return 25;
        if (call_order[1] != 3) return 26;
    } else return 27;
    
    // Test 8: (func_a() || func_b()) && (func_d() || func_c()) - all four called
    reset_tracking();
    if ((func_a() || func_b()) && (func_d() || func_c())) {
        if (global_counter != 3) return 28;
        if (call_order[0] != 1) return 29;
        if (call_order[1] != 4) return 30;
        if (call_order[2] != 3) return 31;
    } else return 32;
    
    // Test 9: (func_b() && func_a()) || (func_c() && func_d()) - b is false, c called, d called
    reset_tracking();
    if ((func_b() && func_a()) || (func_c() && func_d())) {
        return 33;
    } else {
        if (global_counter != 3) return 34;
        if (call_order[0] != 2) return 35;
        if (call_order[1] != 3) return 36;
        if (call_order[2] != 4) return 37;
    }
    
    // Test 10: func_a() || func_b() && func_c() - a is true, short-circuits
    reset_tracking();
    if (func_a() || func_b() && func_c()) {
        if (global_counter != 1) return 38;
        if (call_order[0] != 1) return 39;
    } else return 40;
    
    // Test 11: func_b() && func_a() || func_d() && func_c() - b short-circuits, d short-circuits
    reset_tracking();
    if (func_b() && func_a() || func_d() && func_c()) {
        return 41;
    } else {
        if (global_counter != 2) return 42;
        if (call_order[0] != 2) return 43;
        if (call_order[1] != 4) return 44;
    }
    
    // Test 12: (func_a() && func_b()) || (func_c() && func_a()) - four calls: a,b,c,a
    reset_tracking();
    if ((func_a() && func_b()) || (func_c() && func_a())) {
        if (global_counter != 4) return 45;
        if (call_order[0] != 1) return 46;
        if (call_order[1] != 2) return 47;
        if (call_order[2] != 3) return 48;
        if (call_order[3] != 1) return 49;
    } else return 50;
    
    // Test 13: Complex nesting - (a || b) && ((c && d) || a)
    reset_tracking();
    if ((func_a() || func_b()) && ((func_c() && func_d()) || func_a())) {
        if (global_counter != 4) return 51;
        if (call_order[0] != 1) return 52;
        if (call_order[1] != 3) return 53;
        if (call_order[2] != 4) return 54;
        if (call_order[3] != 1) return 55;
    } else return 56;
    
    // Test 14: (b || c) && (a || d) && c - four calls
    reset_tracking();
    if ((func_b() || func_c()) && (func_a() || func_d()) && func_c()) {
        if (global_counter != 4) return 57;
        if (call_order[0] != 2) return 58;
        if (call_order[1] != 3) return 59;
        if (call_order[2] != 1) return 60;
        if (call_order[3] != 3) return 61;
    } else return 62;
    
    // Test 15: Deeply nested - ((a && b) || c) && (d || (a && c))
    reset_tracking();
    if (((func_a() && func_b()) || func_c()) && (func_d() || (func_a() && func_c()))) {
        if (global_counter != 6) return 63;
        if (call_order[0] != 1) return 64;
        if (call_order[1] != 2) return 65;
        if (call_order[2] != 3) return 66;
        if (call_order[3] != 4) return 67;
        if (call_order[4] != 1) return 68;
        if (call_order[5] != 3) return 69;
    } else return 70;
    
    return 0;
}
